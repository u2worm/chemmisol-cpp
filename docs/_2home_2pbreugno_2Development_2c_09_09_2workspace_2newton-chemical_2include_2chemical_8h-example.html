<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>chemical-newton: /home/pbreugno/Development/c++/workspace/newton-chemical/include/chemical.h</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">chemical-newton
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">/home/pbreugno/Development/c++/workspace/newton-chemical/include/chemical.h</div></div>
</div><!--header-->
<div class="contents">
<p>Returns the value of f for the provided extent.</p>
<p>Let's consider an example chemical system where two reactions occur:</p><ul>
<li>H2O &lt;-&gt; H+ + HO-</li>
<li>Na+ + Cl- &lt;-&gt; NaCl</li>
<li>Na+ + H2O &lt;-&gt; NaOH + H+</li>
</ul>
<p>The <a href="https://en.wikipedia.org/wiki/Law_of_mass_action">law of mass action</a> states that at equilibrium the following relation should hold:</p><ul>
<li><code>[H2O]/([H+]*[HO-]) = K1</code></li>
<li><code>[Na+]*[Cl-]/[NaCl] = K2</code></li>
<li><code>[NaÂµ][H2O]/([NaOH]*[H+]) = K3</code></li>
</ul>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;array&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;unordered_map&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;memory&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;linear.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;units.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span>mineral {</div>
<div class="line">    <span class="keyword">class </span>ChemicalSystem;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">namespace </span>solver {</div>
<div class="line">        <span class="keyword">typedef</span> std::vector&lt;double&gt; <a id="a0" name="a0"></a><a class="code hl_typedef" href="namespacemineral_1_1solver.html#a059039ee8a8a133d568ae67e9e994828">X</a>;</div>
<div class="line">        <span class="keyword">typedef</span> std::vector&lt;std::vector&lt;double&gt;&gt; <a id="a1" name="a1"></a><a class="code hl_typedef" href="namespacemineral_1_1solver.html#a850fceb760e730f76a4d68a23b0f864f">M</a>;</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">class </span>F {</div>
<div class="line">            <span class="keyword">private</span>:</div>
<div class="line">                <span class="keyword">const</span> ChemicalSystem&amp; system;</div>
<div class="line">                std::vector&lt;double&gt; init_concentrations;</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">public</span>:</div>
<div class="line">                <a class="code hl_typedef" href="namespacemineral_1_1solver.html#a059039ee8a8a133d568ae67e9e994828">X</a> <a id="a2" name="a2"></a><a class="code hl_function" href="classmineral_1_1solver_1_1F.html#a43649981fdc155eeb34a67139449fafe">concentrations</a>(<span class="keyword">const</span> <a class="code hl_typedef" href="namespacemineral_1_1solver.html#a059039ee8a8a133d568ae67e9e994828">X</a>&amp; extents) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">                F(<span class="keyword">const</span> ChemicalSystem&amp; system);</div>
<div class="line"> </div>
<div class="line">                <a class="code hl_typedef" href="namespacemineral_1_1solver.html#a059039ee8a8a133d568ae67e9e994828">X</a> f(<span class="keyword">const</span> <a class="code hl_typedef" href="namespacemineral_1_1solver.html#a059039ee8a8a133d568ae67e9e994828">X</a>&amp; extent) <span class="keyword">const</span>;</div>
<div class="line">                <a class="code hl_typedef" href="namespacemineral_1_1solver.html#a850fceb760e730f76a4d68a23b0f864f">M</a> df(<span class="keyword">const</span> <a class="code hl_typedef" href="namespacemineral_1_1solver.html#a059039ee8a8a133d568ae67e9e994828">X</a>&amp; extent) <span class="keyword">const</span>;</div>
<div class="line">        };</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_typedef" href="namespacemineral_1_1solver.html#a059039ee8a8a133d568ae67e9e994828">X</a> solve(<span class="keyword">const</span> ChemicalSystem&amp; system);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">class </span>Component {</div>
<div class="line">        <span class="keyword">public</span>:</div>
<div class="line">            <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> V;</div>
<div class="line">        <span class="keyword">private</span>:</div>
<div class="line">            std::string name;</div>
<div class="line">            std::size_t index;</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">public</span>:</div>
<div class="line">            Component(<span class="keyword">const</span> std::string&amp; name, std::size_t index)</div>
<div class="line">                : name(name), index(index) {</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">const</span> std::string&amp; getName()<span class="keyword"> const </span>{</div>
<div class="line">                <span class="keywordflow">return</span> name;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            std::size_t getIndex()<span class="keyword"> const </span>{</div>
<div class="line">                <span class="keywordflow">return</span> index;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">virtual</span> <span class="keywordtype">void</span> incrementConcentration(<span class="keywordtype">double</span> extent) = 0;</div>
<div class="line">            <span class="keyword">virtual</span> <span class="keywordtype">double</span> concentration(<span class="keywordtype">double</span> current_concentration, <span class="keywordtype">double</span> extent) <span class="keyword">const</span> = 0;</div>
<div class="line">            <span class="keyword">virtual</span> <span class="keywordtype">double</span> concentration() <span class="keyword">const</span> = 0;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordtype">double</span> activity()<span class="keyword"> const </span>{</div>
<div class="line">                <span class="keywordflow">return</span> activity(concentration());</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">virtual</span> <span class="keywordtype">double</span> activity(<span class="keywordtype">double</span> current_concentration) <span class="keyword">const</span> = 0;</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">virtual</span> <span class="keywordtype">double</span> activity(</div>
<div class="line">                    <span class="keyword">const</span> std::vector&lt;double&gt;&amp; current_concentrations,</div>
<div class="line">                    <span class="keywordtype">double</span> extent) <span class="keyword">const</span> = 0;</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a id="a3" name="a3"></a><a class="code hl_function" href="classmineral_1_1Component.html#ab541c406d4d991d1906bae2f7c0bc578">Dactivity</a>(</div>
<div class="line">                    <span class="keyword">const</span> std::vector&lt;double&gt;&amp; current_concentrations,</div>
<div class="line">                    <span class="keywordtype">double</span> d_coef</div>
<div class="line">                    ) <span class="keyword">const</span> = 0;</div>
<div class="line">            </div>
<div class="line">            <span class="keyword">virtual</span> ~Component() {</div>
<div class="line">            }</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">class </span>Solvent : <span class="keyword">public</span> Component {</div>
<div class="line">        <span class="keyword">public</span>:</div>
<div class="line">            Solvent(<span class="keyword">const</span> std::string&amp; name, std::size_t <span class="keywordtype">id</span>)</div>
<div class="line">                : Component(name, <span class="keywordtype">id</span>) {</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordtype">void</span> incrementConcentration(<span class="keywordtype">double</span>)<span class="keyword"> override </span>{</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordtype">double</span> concentration(<span class="keywordtype">double</span>, <span class="keywordtype">double</span>)<span class="keyword"> const override </span>{</div>
<div class="line">                <span class="keywordflow">return</span> 0.0;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordtype">double</span> concentration()<span class="keyword"> const override </span>{</div>
<div class="line">                <span class="keywordflow">return</span> 1.0;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordtype">double</span> activity(<span class="keywordtype">double</span>)<span class="keyword"> const override </span>{</div>
<div class="line">                <span class="keywordflow">return</span> 1.0;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordtype">double</span> activity(<span class="keyword">const</span> std::vector&lt;double&gt;&amp;,  <span class="keywordtype">double</span>)<span class="keyword"> const override </span>{</div>
<div class="line">                <span class="keywordflow">return</span> 1.0;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordtype">double</span> <a id="a4" name="a4"></a><a class="code hl_function" href="classmineral_1_1Solvent.html#ad4476becf3abf4b65fb7702e42b366b8">Dactivity</a>(</div>
<div class="line">                    <span class="keyword">const</span> std::vector&lt;double&gt;&amp;,</div>
<div class="line">                    <span class="keywordtype">double</span></div>
<div class="line">                    )<span class="keyword"> const override </span>{</div>
<div class="line">                <span class="keywordflow">return</span> 0.0;</div>
<div class="line">            }</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">class </span>AqueousComponent : <span class="keyword">public</span> Component {</div>
<div class="line">        <span class="keyword">private</span>:</div>
<div class="line">            <span class="keywordtype">double</span> C;</div>
<div class="line">        </div>
<div class="line">        <span class="keyword">public</span>:</div>
<div class="line">            AqueousComponent(</div>
<div class="line">                    <span class="keyword">const</span> std::string&amp; name, std::size_t <span class="keywordtype">id</span>,</div>
<div class="line">                    <span class="keywordtype">double</span> C)</div>
<div class="line">                : Component(name, <span class="keywordtype">id</span>), C(C) {</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordtype">void</span> incrementConcentration(<span class="keywordtype">double</span> extent)<span class="keyword"> override </span>{</div>
<div class="line">                C+=extent/V;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordtype">double</span> concentration(<span class="keywordtype">double</span> current_concentration, <span class="keywordtype">double</span> extent)<span class="keyword"> const override</span>{</div>
<div class="line">                <span class="keywordflow">return</span> current_concentration + extent/V;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordtype">double</span> concentration()<span class="keyword"> const override </span>{</div>
<div class="line">                <span class="keywordflow">return</span> C;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordtype">double</span> activity(<span class="keywordtype">double</span> current_concentration)<span class="keyword"> const override </span>{</div>
<div class="line">                <span class="keywordflow">return</span> current_concentration/(1*mol/l);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordtype">double</span> activity(</div>
<div class="line">                    <span class="keyword">const</span> std::vector&lt;double&gt;&amp; current_concentrations,</div>
<div class="line">                    <span class="keywordtype">double</span> extent)<span class="keyword"> const override </span>{</div>
<div class="line">                <span class="keywordflow">return</span> activity(current_concentrations[getIndex()] + (extent/V));</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordtype">double</span> <a id="a5" name="a5"></a><a class="code hl_function" href="classmineral_1_1AqueousComponent.html#a3db445588f144a3062484ddbc9649b6a">Dactivity</a>(</div>
<div class="line">                    <span class="keyword">const</span> std::vector&lt;double&gt;&amp;,</div>
<div class="line">                    <span class="keywordtype">double</span> d_coef</div>
<div class="line">                    )<span class="keyword"> const override </span>{</div>
<div class="line">                <span class="comment">// Note: this is 0 if d_coef=0, i.e. if the reaction k does not</span></div>
<div class="line">                <span class="comment">// use this component.</span></div>
<div class="line">                <span class="keywordflow">return</span> (d_coef/V)/(1*mol/l);</div>
<div class="line">            }</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">class </span>MineralComponent : <span class="keyword">public</span> Component {</div>
<div class="line">        <span class="keyword">private</span>:</div>
<div class="line">            <span class="keywordtype">double</span> fraction; <span class="comment">// S/N</span></div>
<div class="line">            <span class="keywordtype">double</span> N;</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">public</span>:</div>
<div class="line">            MineralComponent(</div>
<div class="line">                    <span class="keyword">const</span> std::string&amp; name, std::size_t <span class="keywordtype">id</span>,</div>
<div class="line">                    <span class="keywordtype">double</span> solid_concentration,</div>
<div class="line">                    <span class="keywordtype">double</span> specific_surface_area,</div>
<div class="line">                    <span class="keywordtype">double</span> site_concentration,</div>
<div class="line">                    <span class="keywordtype">double</span> fraction)</div>
<div class="line">                : Component(name, <span class="keywordtype">id</span>), fraction(fraction),</div>
<div class="line">                N(V*solid_concentration*specific_surface_area*site_concentration) {</div>
<div class="line">                }</div>
<div class="line">            MineralComponent(</div>
<div class="line">                    <span class="keyword">const</span> std::string&amp; name, std::size_t <span class="keywordtype">id</span>,</div>
<div class="line">                    <span class="keywordtype">double</span> fraction)</div>
<div class="line">                : Component(name, <span class="keywordtype">id</span>), fraction(fraction) {</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordtype">void</span> incrementConcentration(<span class="keywordtype">double</span> extent)<span class="keyword"> override </span>{</div>
<div class="line">                fraction+=extent/N;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordtype">double</span> concentration(<span class="keywordtype">double</span> current_concentration, <span class="keywordtype">double</span> extent)<span class="keyword"> const override</span>{</div>
<div class="line">                <span class="keywordflow">return</span> current_concentration + extent/N;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordtype">double</span> concentration()<span class="keyword"> const override </span>{</div>
<div class="line">                <span class="keywordflow">return</span> fraction;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordtype">double</span> activity(<span class="keywordtype">double</span> current_concentration)<span class="keyword"> const override </span>{</div>
<div class="line">                <span class="keywordflow">return</span> current_concentration;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordtype">double</span> activity(</div>
<div class="line">                    <span class="keyword">const</span> std::vector&lt;double&gt;&amp; current_concentrations,</div>
<div class="line">                    <span class="keywordtype">double</span> extent)<span class="keyword"> const override </span>{</div>
<div class="line">                <span class="keywordflow">return</span> activity(current_concentrations[getIndex()]+(extent/N));</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordtype">double</span> <a id="a6" name="a6"></a><a class="code hl_function" href="classmineral_1_1MineralComponent.html#acfa247b6a38a610b24e365c05f5b1a7f">Dactivity</a>(</div>
<div class="line">                    <span class="keyword">const</span> std::vector&lt;double&gt;&amp;,</div>
<div class="line">                    <span class="keywordtype">double</span> d_coef</div>
<div class="line">                    )<span class="keyword"> const override </span>{</div>
<div class="line">                <span class="comment">// Note: this is 0 if d_coef=0, i.e. if the reaction k does not</span></div>
<div class="line">                <span class="comment">// use this component.</span></div>
<div class="line">                <span class="keywordflow">return</span> d_coef/N;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">class </span>Reaction {</div>
<div class="line">        <span class="keyword">private</span>:</div>
<div class="line">            std::string name;</div>
<div class="line">            std::size_t index;</div>
<div class="line">            <span class="keywordtype">double</span> log_K;</div>
<div class="line">            std::unordered_map&lt;std::string, double&gt; reactives;</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">public</span>:</div>
<div class="line">            Reaction(</div>
<div class="line">                    <span class="keyword">const</span> std::string&amp; name, std::size_t index, <span class="keywordtype">double</span> log_K,</div>
<div class="line">                    <span class="keyword">const</span> std::unordered_map&lt;std::string, double&gt;&amp; reactives</div>
<div class="line">                    )</div>
<div class="line">                : name(name), index(index), log_K(log_K), reactives(reactives) {</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">const</span> std::string&amp; getName()<span class="keyword"> const </span>{</div>
<div class="line">                <span class="keywordflow">return</span> name;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            std::size_t getIndex()<span class="keyword"> const </span>{</div>
<div class="line">                <span class="keywordflow">return</span> index;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordtype">double</span> getLogK()<span class="keyword"> const </span>{</div>
<div class="line">                <span class="keywordflow">return</span> log_K;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">const</span> std::unordered_map&lt;std::string, double&gt; getReactives()<span class="keyword"> const </span>{</div>
<div class="line">                <span class="keywordflow">return</span> reactives;</div>
<div class="line">            }</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">class </span>ChemicalSystem {</div>
<div class="line">        <span class="keyword">private</span>:</div>
<div class="line">            std::size_t component_index = 0;</div>
<div class="line">            std::size_t reaction_index = 0;</div>
<div class="line"> </div>
<div class="line">            std::vector&lt;std::unique_ptr&lt;Component&gt;&gt; components;</div>
<div class="line">            std::unordered_map&lt;std::string, const Component*&gt; components_by_name;</div>
<div class="line">            std::vector&lt;std::unique_ptr&lt;Reaction&gt;&gt; reactions;</div>
<div class="line">            std::unordered_map&lt;std::string, const Reaction*&gt; reactions_by_name;</div>
<div class="line">            std::vector&lt;std::vector&lt;double&gt;&gt; reaction_matrix;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordtype">void</span> addComponent(Component* component);</div>
<div class="line">            <span class="keywordtype">void</span> addReaction(Reaction* reaction);</div>
<div class="line"> </div>
<div class="line">            std::size_t max_iteration = 20;</div>
<div class="line">        <span class="keyword">public</span>:</div>
<div class="line">            <span class="keywordtype">void</span> addReaction(</div>
<div class="line">                    std::string name,</div>
<div class="line">                    <span class="keywordtype">double</span> log_K,</div>
<div class="line">                    std::unordered_map&lt;std::string, double&gt; reactives</div>
<div class="line">                    );</div>
<div class="line">            <span class="keywordtype">void</span> addComponent(</div>
<div class="line">                    std::string name,</div>
<div class="line">                    <span class="keywordtype">double</span> concentration</div>
<div class="line">                    );</div>
<div class="line">            <span class="keywordtype">void</span> initPH(<span class="keywordtype">double</span> pH);</div>
<div class="line">            <span class="keywordtype">void</span> fixPH(<span class="keywordtype">double</span> pH);</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">const</span> Reaction&amp; getReaction(<span class="keyword">const</span> std::string&amp; name) <span class="keyword">const</span>;</div>
<div class="line">            <span class="keyword">const</span> Component&amp; getComponent(<span class="keyword">const</span> std::string&amp; name) <span class="keyword">const</span>;</div>
<div class="line">            <span class="keyword">const</span> Component&amp; getComponent(<span class="keyword">const</span> std::size_t&amp; <span class="keywordtype">id</span>) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">const</span> std::vector&lt;std::unique_ptr&lt;Component&gt;&gt;&amp; getComponents()<span class="keyword"> const </span>{</div>
<div class="line">                <span class="keywordflow">return</span> components;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">const</span> std::vector&lt;std::unique_ptr&lt;Reaction&gt;&gt;&amp; getReactions()<span class="keyword"> const </span>{</div>
<div class="line">                <span class="keywordflow">return</span> reactions;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">const</span> std::vector&lt;std::vector&lt;double&gt;&gt;&amp; getReactionMatrix()<span class="keyword"> const </span>{</div>
<div class="line">                <span class="keywordflow">return</span> reaction_matrix;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordtype">void</span> initReactionMatrix();</div>
<div class="line">            <span class="keywordtype">void</span> solveEquilibrium();</div>
<div class="line">            <span class="keywordtype">double</span> reactionQuotient(<span class="keyword">const</span> std::string&amp; name) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">            std::size_t getMaxIteration()<span class="keyword"> const </span>{</div>
<div class="line">                <span class="keywordflow">return</span> max_iteration;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordtype">void</span> setMaxIteration(<span class="keyword">const</span> std::size_t&amp; max_iteration) {</div>
<div class="line">                this-&gt;max_iteration = max_iteration;</div>
<div class="line">            }</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> *    class Soil {</span></div>
<div class="line"><span class="comment"> *        public:</span></div>
<div class="line"><span class="comment"> *        static const double bulk_density;</span></div>
<div class="line"><span class="comment"> *        static const double V;</span></div>
<div class="line"><span class="comment"> *        static const double mineral_weight;</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *        private:</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *        double _K1;</span></div>
<div class="line"><span class="comment"> *        double _K2;</span></div>
<div class="line"><span class="comment"> *        double _K3;</span></div>
<div class="line"><span class="comment"> *        double _initPH;</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *        double H;</span></div>
<div class="line"><span class="comment"> *        double P;</span></div>
<div class="line"><span class="comment"> *        double C;</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *        double N;</span></div>
<div class="line"><span class="comment"> *        double S;</span></div>
<div class="line"><span class="comment"> *        double SH;</span></div>
<div class="line"><span class="comment"> *        double SP;</span></div>
<div class="line"><span class="comment"> *        double SC;</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *        double concentration(const double&amp; n) const;</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *        private:</span></div>
<div class="line"><span class="comment"> *        ChemicalSystem(</span></div>
<div class="line"><span class="comment"> *                double K1, double K2, double K3, double initPH,</span></div>
<div class="line"><span class="comment"> *                double H, double P, double C,</span></div>
<div class="line"><span class="comment"> *                double N,</span></div>
<div class="line"><span class="comment"> *                double S, double SH, double SP, double SC</span></div>
<div class="line"><span class="comment"> *                );</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *        public:</span></div>
<div class="line"><span class="comment"> *        static ChemicalSystem equilibrium(</span></div>
<div class="line"><span class="comment"> *                double K1, double K2, double K3,</span></div>
<div class="line"><span class="comment"> *                double pH, double solution_P, double solution_C,</span></div>
<div class="line"><span class="comment"> *                double mineral_N</span></div>
<div class="line"><span class="comment"> *                );</span></div>
<div class="line"><span class="comment"> *        static ChemicalSystem defaultEquilibrium();</span></div>
<div class="line"><span class="comment"> *        static ChemicalSystem Devau2011Control();</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *        //static ChemicalSystem soilParameters(</span></div>
<div class="line"><span class="comment"> *        //double K1, double K2, double K3,</span></div>
<div class="line"><span class="comment"> *        //double pH, double soil_P, double soil_C,</span></div>
<div class="line"><span class="comment"> *        //double mineral_N</span></div>
<div class="line"><span class="comment"> *        //);</span></div>
<div class="line"><span class="comment"> *        //static ChemicalSystem defaultSoil();</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *        void incrementP(double P);</span></div>
<div class="line"><span class="comment"> *        void setPH(double pH);</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *        //X reactionQuotient() const;</span></div>
<div class="line"><span class="comment"> *        void distanceToEquilibrium() const;</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *        double cH() const;</span></div>
<div class="line"><span class="comment"> *        double cP() const;</span></div>
<div class="line"><span class="comment"> *        double cC() const;</span></div>
<div class="line"><span class="comment"> *        double cS() const;</span></div>
<div class="line"><span class="comment"> *        double cSH() const;</span></div>
<div class="line"><span class="comment"> *        double cSP() const;</span></div>
<div class="line"><span class="comment"> *        double cSC() const;</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *        double nH() const;</span></div>
<div class="line"><span class="comment"> *        double nP() const;</span></div>
<div class="line"><span class="comment"> *        double nC() const;</span></div>
<div class="line"><span class="comment"> *        double nS() const;</span></div>
<div class="line"><span class="comment"> *        double nSH() const;</span></div>
<div class="line"><span class="comment"> *        double nSP() const;</span></div>
<div class="line"><span class="comment"> *        double nSC() const;</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *        double K1() const;</span></div>
<div class="line"><span class="comment"> *        double K2() const;</span></div>
<div class="line"><span class="comment"> *        double K3() const;</span></div>
<div class="line"><span class="comment"> *        double initPH() const;</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *        double pH() const;</span></div>
<div class="line"><span class="comment"> *    };</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line">}</div>
<div class="ttc" id="aclassmineral_1_1AqueousComponent_html_a3db445588f144a3062484ddbc9649b6a"><div class="ttname"><a href="classmineral_1_1AqueousComponent.html#a3db445588f144a3062484ddbc9649b6a">mineral::AqueousComponent::Dactivity</a></div><div class="ttdeci">double Dactivity(const std::vector&lt; double &gt; &amp;, double d_coef) const override</div><div class="ttdef"><b>Definition</b> chemical.h:212</div></div>
<div class="ttc" id="aclassmineral_1_1Component_html_ab541c406d4d991d1906bae2f7c0bc578"><div class="ttname"><a href="classmineral_1_1Component.html#ab541c406d4d991d1906bae2f7c0bc578">mineral::Component::Dactivity</a></div><div class="ttdeci">virtual double Dactivity(const std::vector&lt; double &gt; &amp;current_concentrations, double d_coef) const =0</div></div>
<div class="ttc" id="aclassmineral_1_1MineralComponent_html_acfa247b6a38a610b24e365c05f5b1a7f"><div class="ttname"><a href="classmineral_1_1MineralComponent.html#acfa247b6a38a610b24e365c05f5b1a7f">mineral::MineralComponent::Dactivity</a></div><div class="ttdeci">double Dactivity(const std::vector&lt; double &gt; &amp;, double d_coef) const override</div><div class="ttdef"><b>Definition</b> chemical.h:264</div></div>
<div class="ttc" id="aclassmineral_1_1Solvent_html_ad4476becf3abf4b65fb7702e42b366b8"><div class="ttname"><a href="classmineral_1_1Solvent.html#ad4476becf3abf4b65fb7702e42b366b8">mineral::Solvent::Dactivity</a></div><div class="ttdeci">double Dactivity(const std::vector&lt; double &gt; &amp;, double) const override</div><div class="ttdef"><b>Definition</b> chemical.h:171</div></div>
<div class="ttc" id="aclassmineral_1_1solver_1_1F_html_a43649981fdc155eeb34a67139449fafe"><div class="ttname"><a href="classmineral_1_1solver_1_1F.html#a43649981fdc155eeb34a67139449fafe">mineral::solver::F::concentrations</a></div><div class="ttdeci">X concentrations(const X &amp;extents) const</div></div>
<div class="ttc" id="anamespacemineral_1_1solver_html_a059039ee8a8a133d568ae67e9e994828"><div class="ttname"><a href="namespacemineral_1_1solver.html#a059039ee8a8a133d568ae67e9e994828">mineral::solver::X</a></div><div class="ttdeci">std::vector&lt; double &gt; X</div><div class="ttdef"><b>Definition</b> chemical.h:24</div></div>
<div class="ttc" id="anamespacemineral_1_1solver_html_a850fceb760e730f76a4d68a23b0f864f"><div class="ttname"><a href="namespacemineral_1_1solver.html#a850fceb760e730f76a4d68a23b0f864f">mineral::solver::M</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; M</div><div class="ttdef"><b>Definition</b> chemical.h:31</div></div>
</div><!-- fragment --> </div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.7
</small></address>
</body>
</html>
